# SLOとエラー・バジェットで意思決定を行う

SLOを一度設けると、意思決定にそれらを使い始めることができます。

明確な決断は、SLOを満たしていないとき、すなわちエラー・バジェットを使い果たしたときの対処からスタートします。
既に説明したように、エラー・バジェットを使い果たしたときの適切な一連の行動は、エラー・バジェットポリシーで網羅されるべきです。
一般的なポリシーには、サービスが再びSLO内になるまで機能のローンチを停止すること、または信頼性関連のバグに取り組むためのエンジニアリング時間の一部または全部を費やすことが含まれます。

極端な状況では、チームはサービスが終了基準を満たすまで、すべての外部要求(例えば他チームからの要求など)の優先順位を下げるための高度な承認を得て緊急事態を宣言することができます。通常、サービスはSLOの範囲内であり、後々SLOが失敗する可能性を減らすために対策を講じることになります。
これらのステップには、既知の障害を削除するために、モニタリングの改善、テストの改善、危険な依存関係の削除、またはシステムのリアーキテクティングが含まれます。

消費したエラーバジェットの割合に応じてインシデントの規模を決定することができ、このデータを使用して詳細調査に値する最も重要なインシデントを特定することができます。

例えば、4時間後にシステムを元に戻すことができるまで、新しいAPIバージョンのリリースによってNullPointerExceptionが100%発生するとします。
生のサーバログを調べると、この問題により14,066エラーが発生したことが分かります。
以前の97％SLOの数値と109,897エラー・バジェットを使用すると、この単一のイベントでエラー・バジェットの13％が使用されました。

あるいは、私たちの単独の状態データベースが格納されているサーバーに障害が発生し、バックアップからの復元に20時間かかるかも知れません。
我々は(この期間の過去のトラフィックに基づいて)この停止により、72,000エラー、つまりエラー・バジェットの65％相当が発生したと推定します。

例にある会社では、5年間で1回しかサーバ障害が発生していませんでしたが、一般的に1年に2回または3回ロールバックが必要な不良リリースが発生しています。
平均すると、悪いプッシュによってデータベース障害の2倍のエラー・バジェットを消費すると推定できます。
この数値は、リリース問題に対処することで、サーバ障害の調査にリソースを投資するよりもはるかに多くの利点があることを証明しています。

サービスが問題なく実行されており、ほとんど監視を必要としない場合は、サービスをより実践的なサポートの段階に移行する時期が来るかもしれません。
引き続きインシデント対応管理と高度な監視を提供するかもしれませんが、もはや日常的に製品に密接に関わる必要はありません。
したがって、より多くのSREサポートを必要とする他のシステムにあなたの努力を集中させることができます。

表2-5に、3つの重要な側面に基づいて推奨される一連のアクションを示します。

* SLOに対するパフォーマンス
* サービスを運用するために必要なトイル
* サービスに対する顧客満足度

表2-5. SLO意思決定表

|    SLO     | トイル | 顧客満足度 |                                                                                          アクション                                                                                           |
| ---------- | ------ | ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 満たす     | 低     | 高         | (a)リリースとデプロイのプロセスを緩和して速度を上げるか、(b)エンゲージメントから身を引いてエンジニアリング時間をより信頼性が必要なサービスに集中させるかを選択します。                        |
| 満たす     | 低     | 低         | SLOを厳しくします。                                                                                                                                                                           |
| 満たす     | 高     | 高         | アラートによって誤検知が発生している場合は、感度を下げます。そうでない場合は、SLOを一時的に緩めて(またはトイルを取り払って)プロダクトを修正するか、自動化された障害軽減策を改善してください。 |
| 満たす     | 高     | 低         | SLOを厳しくします。                                                                                                                                                                           |
| 満たさない | 低     | 高         | SLOを緩和します。                                                                                                                                                                             |
| 満たさない | 低     | 低         | アラート感度を上げます。                                                                                                                                                                      |
| 満たさない | 高     | 高         | SLOを緩和します。                                                                                                                                                                             |
| 満たさない | 高     | 低         | トイルを取り払い、自動化された障害軽減策を改善してください。                                                                                                                                  |

----------
【8】ここで繰り返し説明する価値があるのは、エラー・バジェットはユーザ満足度の近似値であるということです。30日ごとに4時間停止することは30日ごとに1時間停止する回数が4回になるよりも不幸なユーザ数が少なくなります。同様に0.5％という一定のエラー率よりも不幸なユーザが少なくなるでしょう。しかし、エラー・バジェットは同一のものとして扱います。これらのしきい値はサービスによって異なります。
